import React, { useState } from 'react';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Switch } from '@/components/ui/switch';
import { Settings, CreditCard, Mail, Bell, Shield, Palette, Database } from 'lucide-react';
import { toast } from 'sonner';

export default function Configuracoes() {
  const [config, setConfig] = useState({
    envio_cartao_padrao: 'cooperativa',
    limite_diario_padrao: 3000,
    taxa_juros_rotativo: 12.5,
    taxa_multa_atraso: 2.0,
    dias_cessao_credito: 90,
    anuidade_ativa: true,
    valor_anuidade_classic: 60,
    valor_anuidade_gold: 120,
    valor_anuidade_platinum: 240,
    valor_anuidade_infinite: 480,
    notificacao_email_ativa: true,
    notificacao_sms_ativa: true,
    notificacao_whatsapp_ativa: false,
    email_remetente: 'noreply@hubcoop.com.br',
    nome_remetente: 'Hubcoop Cartões',
    autenticacao_2fa: true,
    tempo_sessao: 30,
    backup_automatico: true,
    frequencia_backup: 'diario'
  });

  const handleChange = (field, value) => {
    setConfig(prev => ({ ...prev, [field]: value }));
  };

  const handleSave = () => {
    toast.success('Configurações salvas com sucesso!');
  };

  return (
    <div className="space-y-6">
      <Card className="border-t-4 border-t-[#4A9B8E]">
        <CardHeader>
          <div className="flex items-center gap-3">
            <div className="p-3 rounded-xl bg-[#4A9B8E]/10">
              <Settings className="w-6 h-6 text-[#4A9B8E]" />
            </div>
            <div>
              <CardTitle className="text-2xl">Configurações do Sistema</CardTitle>
              <CardDescription>Gerencie as configurações gerais do portal</CardDescription>
            </div>
          </div>
        </CardHeader>
      </Card>

      <Tabs defaultValue="cartoes" className="space-y-6">
        <TabsList className="grid w-full grid-cols-5">
          <TabsTrigger value="cartoes" className="flex items-center gap-2">
            <CreditCard className="w-4 h-4" />
            Cartões
          </TabsTrigger>
          <TabsTrigger value="notificacoes" className="flex items-center gap-2">
            <Bell className="w-4 h-4" />
            Notificações
          </TabsTrigger>
          <TabsTrigger value="financeiro" className="flex items-center gap-2">
            <Database className="w-4 h-4" />
            Financeiro
          </TabsTrigger>
          <TabsTrigger value="seguranca" className="flex items-center gap-2">
            <Shield className="w-4 h-4" />
            Segurança
          </TabsTrigger>
          <TabsTrigger value="aparencia" className="flex items-center gap-2">
            <Palette className="w-4 h-4" />
            Aparência
          </TabsTrigger>
        </TabsList>

        <TabsContent value="cartoes" className="space-y-6">
          <Card>
            <CardHeader>
              <CardTitle className="text-lg">Configurações de Cartões</CardTitle>
              <CardDescription>Defina as configurações padrão para emissão de cartões</CardDescription>
            </CardHeader>
            <CardContent className="space-y-6">
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div className="space-y-2">
                  <Label>Destino de Envio Padrão</Label>
                  <Select value={config.envio_cartao_padrao} onValueChange={(value) => handleChange('envio_cartao_padrao', value)}>
                    <SelectTrigger>
                      <SelectValue />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="cooperativa">Enviar para Cooperativa</SelectItem>
                      <SelectItem value="cooperado">Enviar direto ao Cooperado</SelectItem>
                    </SelectContent>
                  </Select>
                </div>

                <div className="space-y-2">
                  <Label>Limite Diário Padrão (R$)</Label>
                  <Input
                    type="number"
                    value={config.limite_diario_padrao}
                    onChange={(e) => handleChange('limite_diario_padrao', parseFloat(e.target.value))}
                  />
                </div>
              </div>

              <div className="border-t pt-6">
                <h3 className="font-semibold mb-4">Anuidades</h3>
                <div className="flex items-center justify-between mb-4">
                  <div>
                    <Label>Anuidade Ativa</Label>
                    <p className="text-sm text-slate-500">Cobrar anuidade dos cartões</p>
                  </div>
                  <Switch
                    checked={config.anuidade_ativa}
                    onCheckedChange={(checked) => handleChange('anuidade_ativa', checked)}
                  />
                </div>

                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                  <div className="space-y-2">
                    <Label>Classic (R$)</Label>
                    <Input
                      type="number"
                      value={config.valor_anuidade_classic}
                      onChange={(e) => handleChange('valor_anuidade_classic', parseFloat(e.target.value))}
                    />
                  </div>
                  <div className="space-y-2">
                    <Label>Gold (R$)</Label>
                    <Input
                      type="number"
                      value={config.valor_anuidade_gold}
                      onChange={(e) => handleChange('valor_anuidade_gold', parseFloat(e.target.value))}
                    />
                  </div>
                  <div className="space-y-2">
                    <Label>Platinum (R$)</Label>
                    <Input
                      type="number"
                      value={config.valor_anuidade_platinum}
                      onChange={(e) => handleChange('valor_anuidade_platinum', parseFloat(e.target.value))}
                    />
                  </div>
                  <div className="space-y-2">
                    <Label>Infinite (R$)</Label>
                    <Input
                      type="number"
                      value={config.valor_anuidade_infinite}
                      onChange={(e) => handleChange('valor_anuidade_infinite', parseFloat(e.target.value))}
                    />
                  </div>
                </div>
              </div>
            </CardContent>
          </Card>
        </TabsContent>

        <TabsContent value="notificacoes" className="space-y-6">
          <Card>
            <CardHeader>
              <CardTitle className="text-lg">Notificações</CardTitle>
              <CardDescription>Configure os canais de comunicação com cooperados</CardDescription>
            </CardHeader>
            <CardContent className="space-y-6">
              <div className="space-y-4">
                <div className="flex items-center justify-between">
                  <div>
                    <Label>Notificações por E-mail</Label>
                    <p className="text-sm text-slate-500">Enviar notificações via e-mail</p>
                  </div>
                  <Switch
                    checked={config.notificacao_email_ativa}
                    onCheckedChange={(checked) => handleChange('notificacao_email_ativa', checked)}
                  />
                </div>

                <div className="flex items-center justify-between">
                  <div>
                    <Label>Notificações por SMS</Label>
                    <p className="text-sm text-slate-500">Enviar notificações via SMS</p>
                  </div>
                  <Switch
                    checked={config.notificacao_sms_ativa}
                    onCheckedChange={(checked) => handleChange('notificacao_sms_ativa', checked)}
                  />
                </div>

                <div className="flex items-center justify-between">
                  <div>
                    <Label>Notificações por WhatsApp</Label>
                    <p className="text-sm text-slate-500">Enviar notificações via WhatsApp</p>
                  </div>
                  <Switch
                    checked={config.notificacao_whatsapp_ativa}
                    onCheckedChange={(checked) => handleChange('notificacao_whatsapp_ativa', checked)}
                  />
                </div>
              </div>

              <div className="border-t pt-6">
                <h3 className="font-semibold mb-4">Configurações de E-mail</h3>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div className="space-y-2">
                    <Label>E-mail Remetente</Label>
                    <Input
                      type="email"
                      value={config.email_remetente}
                      onChange={(e) => handleChange('email_remetente', e.target.value)}
                    />
                  </div>
                  <div className="space-y-2">
                    <Label>Nome do Remetente</Label>
                    <Input
                      value={config.nome_remetente}
                      onChange={(e) => handleChange('nome_remetente', e.target.value)}
                    />
                  </div>
                </div>
              </div>
            </CardContent>
          </Card>
        </TabsContent>

        <TabsContent value="financeiro" className="space-y-6">
          <Card>
            <CardHeader>
              <CardTitle className="text-lg">Configurações Financeiras</CardTitle>
              <CardDescription>Defina taxas e regras financeiras</CardDescription>
            </CardHeader>
            <CardContent className="space-y-6">
              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div className="space-y-2">
                  <Label>Taxa de Juros Rotativo (%)</Label>
                  <Input
                    type="number"
                    step="0.01"
                    value={config.taxa_juros_rotativo}
                    onChange={(e) => handleChange('taxa_juros_rotativo', parseFloat(e.target.value))}
                  />
                  <p className="text-xs text-slate-500">Taxa mensal aplicada ao rotativo</p>
                </div>

                <div className="space-y-2">
                  <Label>Multa por Atraso (%)</Label>
                  <Input
                    type="number"
                    step="0.01"
                    value={config.taxa_multa_atraso}
                    onChange={(e) => handleChange('taxa_multa_atraso', parseFloat(e.target.value))}
                  />
                  <p className="text-xs text-slate-500">Percentual de multa sobre o valor em atraso</p>
                </div>

                <div className="space-y-2">
                  <Label>Dias para Cessão de Crédito</Label>
                  <Input
                    type="number"
                    value={config.dias_cessao_credito}
                    onChange={(e) => handleChange('dias_cessao_credito', parseInt(e.target.value))}
                  />
                  <p className="text-xs text-slate-500">Dias de atraso para enviar à cessão</p>
                </div>
              </div>
            </CardContent>
          </Card>
        </TabsContent>

        <TabsContent value="seguranca" className="space-y-6">
          <Card>
            <CardHeader>
              <CardTitle className="text-lg">Segurança</CardTitle>
              <CardDescription>Configure as políticas de segurança do sistema</CardDescription>
            </CardHeader>
            <CardContent className="space-y-6">
              <div className="space-y-4">
                <div className="flex items-center justify-between">
                  <div>
                    <Label>Autenticação de Dois Fatores (2FA)</Label>
                    <p className="text-sm text-slate-500">Exigir 2FA para todos os usuários</p>
                  </div>
                  <Switch
                    checked={config.autenticacao_2fa}
                    onCheckedChange={(checked) => handleChange('autenticacao_2fa', checked)}
                  />
                </div>

                <div className="space-y-2">
                  <Label>Tempo de Sessão (minutos)</Label>
                  <Input
                    type="number"
                    value={config.tempo_sessao}
                    onChange={(e) => handleChange('tempo_sessao', parseInt(e.target.value))}
                  />
                  <p className="text-xs text-slate-500">Tempo de inatividade antes de expirar a sessão</p>
                </div>
              </div>

              <div className="border-t pt-6">
                <h3 className="font-semibold mb-4">Backup</h3>
                <div className="space-y-4">
                  <div className="flex items-center justify-between">
                    <div>
                      <Label>Backup Automático</Label>
                      <p className="text-sm text-slate-500">Realizar backups automáticos do sistema</p>
                    </div>
                    <Switch
                      checked={config.backup_automatico}
                      onCheckedChange={(checked) => handleChange('backup_automatico', checked)}
                    />
                  </div>

                  <div className="space-y-2">
                    <Label>Frequência de Backup</Label>
                    <Select value={config.frequencia_backup} onValueChange={(value) => handleChange('frequencia_backup', value)}>
                      <SelectTrigger>
                        <SelectValue />
                      </SelectTrigger>
                      <SelectContent>
                        <SelectItem value="horario">A cada hora</SelectItem>
                        <SelectItem value="diario">Diário</SelectItem>
                        <SelectItem value="semanal">Semanal</SelectItem>
                        <SelectItem value="mensal">Mensal</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                </div>
              </div>
            </CardContent>
          </Card>
        </TabsContent>

        <TabsContent value="aparencia" className="space-y-6">
          <Card>
            <CardHeader>
              <CardTitle className="text-lg">Aparência</CardTitle>
              <CardDescription>Personalize a aparência do portal</CardDescription>
            </CardHeader>
            <CardContent className="space-y-6">
              <div className="p-8 border-2 border-dashed rounded-lg text-center">
                <Palette className="w-12 h-12 mx-auto mb-4 text-slate-400" />
                <h3 className="font-semibold text-lg mb-2">Personalização de Tema</h3>
                <p className="text-slate-500 mb-4">
                  As configurações de cor e logomarca já estão aplicadas conforme o branding da Hubcoop
                </p>
                <div className="flex items-center justify-center gap-4 mt-6">
                  <div className="flex flex-col items-center gap-2">
                    <div className="w-16 h-16 rounded-lg bg-[#4A9B8E]" />
                    <span className="text-xs text-slate-600">Cor Primária</span>
                  </div>
                  <div className="flex flex-col items-center gap-2">
                    <div className="w-16 h-16 rounded-lg bg-[#3A7B6E]" />
                    <span className="text-xs text-slate-600">Cor Secundária</span>
                  </div>
                </div>
              </div>
            </CardContent>
          </Card>
        </TabsContent>
      </Tabs>

      <div className="flex justify-end">
        <Button onClick={handleSave} className="bg-[#4A9B8E] hover:bg-[#3A7B6E]" size="lg">
          Salvar Configurações
        </Button>
      </div>
    </div>
  );
}